<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Raw Previewer</title>
  <script>
var fs={};
fs.readFile = function (file, cb){
  var rawFile = new XMLHttpRequest();
  rawFile.overrideMimeType('text/plain; charset=utf-8');
  rawFile.open("GET", file, true);
  rawFile.onload = function () {
    if(rawFile.readyState === 4) {
      if(rawFile.status === 200 || rawFile.status == 0) {
       cb(rawFile.responseText)
      }
    }
  }
  rawFile.send(null);
}

var param = location.search.substring(1);

var FileRaw = param.replace(/\/\/github\.com/, '//raw.githubusercontent.com').replace(/\/blob\//, '/');

var defaultRaw = "https://github.com/dirkncl/myfirst-gh-page/blob/gh-pages/index.html".replace(/\/\/github\.com/, '//raw.githubusercontent.com').replace(/\/blob\//, '/');
var FileRaw = FileRaw||defaultRaw;

var fileName = FileRaw.split('/').pop();
var basePath = FileRaw.replace(fileName,'');
window.onload = function(){
  fs.readFile(FileRaw,function (data){
  data = data.replace(/<head>/i, '<head><base href="' + basePath + '">')
    var ifr = document.createElement('iframe');
    ifr.width = window.innerWidth; 
    ifr.height = window.innerHeight;
    ifr.border = '0px';
    ifr.srcdoc = data;
     document.body.appendChild(ifr);
  })
}
  </script>
</head>
<body>

</body>
</html>
